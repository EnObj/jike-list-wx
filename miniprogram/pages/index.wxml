<wxs module="math">
  module.exports = {
    toFixed: function(number, n) {
      return number.toFixed(n);
    }
  }
</wxs>
<view class="channel-date">
  <view style="margin-right:10px;">
    <scroll-view scroll-x enable-flex style="display:flex;align-items: flex-start;" scroll-into-view="date-{{locDay.int8Date}}">
      <view wx:for="{{dateList}}" wx:key="int8Date" style="flex:none;padding:5px 10px;" id="date-{{item.int8Date}}" bindtap="switchDate" data-date="{{item}}">
        <view class="date-list-item {{item.int8Date == currentDate.int8Date ? 'current-date-item':''}}">
          <view>{{item.int8Date == today.int8Date ? '今天' : '星期' + item.showWeek}}</view>
          <view>{{item.showDate}}</view>
        </view>
      </view>
      <view style="color:white;flex:none;padding:5px 10px;margin:auto 0px;text-align:center;font-weight:600;background:gray;border-radius:5px;">
        <picker mode="date" value="{{today.showDate}}" end="{{today.showDate}}" bindchange="bindDateChange">
          <view>往日</view>
          <view>节目单</view>
        </picker>
      </view>
    </scroll-view>
  </view>
  <scroll-view scroll-x enable-flex style="display:flex;align-items: flex-start;" scroll-into-view="channel-{{currentChannel.code}}">
    <view wx:for="{{channelList}}" wx:key="code" style="flex:none;padding:0 10px;" id="channel-{{item.code}}" bindtap="switchChannel" data-channel="{{item}}">
      <view class="channel-list-item {{item.code == currentChannel.code ? 'current-channel-item':''}}">
        <image style="width:60px;height:40px;" mode="aspectFit" wx:if="{{item.logo}}" src="{{item.logo}}"></image>
        <view wx:else>{{item.code}}</view>
      </view>
    </view>
  </scroll-view>
</view>

<view>
  <scroll-view scroll-y class="programs" scroll-into-view="{{'program-' + currentChannel.code +'-'+ currentDate.int8Date + '-curr'}}">
    <!-- <view wx:for="{{programList}}" wx:key="insideId" class="program-list-item {{index%2?'program-list-item-odd':''}}" id="{{'program-'+item.startTime}}">
      <view style="flex:none;display:flex;width:50px;">
        <view style="margin:auto;">
          <view>
            {{item.showTime}}
          </view>
        </view>
      </view>
      <view style="flex:auto;display:flex">
        <view style="margin:auto 10px;">
          <view style="font-weight:700;color:#333;">
            {{item.title}}
          </view>
          <view class="program-time-length">约{{math.toFixed(item.length/60, 0)}}分钟</view>
        </view>
      </view>
      <view style="flex:none;display:flex;">
        <view class="status-container program-status-bd-{{item.status}} program-status-c-{{item.status}}" wx:if="{{!userActions[item.insideId]}}" bindtap="signAction" data-program-index="{{index}}">
          <view class="program-status program-status-bk-{{item.status}}"></view>
          <view style="margin:0 4px;">{{item.status=='over'?'已播':item.status=='curr'?'在播':'未播'}}</view>
        </view>
        <view class="status-container" wx:else bindtap="unsignAction" data-program-inside-id="{{item.insideId}}">
          <mp-icon icon="bellring-on" color="green" type="field" size="{{15}}" wx:if="{{item.status=='fulture' && userActions[item.insideId].needNotify}}"></mp-icon>
          <view class="program-status program-status-bk-{{item.status}}" wx:else>
          </view>
          <view style="margin:0 4px;" class="program-status-c-{{item.status}}">{{item.status=='over'?'看过':item.status=='curr'?'在看':'想看'}}</view>
        </view>
      </view>
    </view> -->
    <view style="padding:0 10px;" wx:if="{{currentChannel.code && currentDate.int8Date}}">
      <program-list channel="{{currentChannel.code}}" date="{{currentDate.int8Date}}" list="{{programList}}"/>
    </view>
  </scroll-view>
</view>